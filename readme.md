Internal Logic for Pages of History

WIP conversion from PHP